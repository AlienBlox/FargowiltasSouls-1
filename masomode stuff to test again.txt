added overflow check to final spark